---
title: "Tutorial 1 aula 2"
author: "M√¥nica Rocabado"
output:
  word_document: default
  html_notebook: default
  pdf_document: default
---

Resolucao individual do exerc√≠cio. 

```{r, message=FALSE}
library(tidyverse)
pnad <- read_csv("pnad2015.csv")
```

#### *PERGUNTA 1*

_O grupo come√ßa estimando o impacto do sexo, uma vari√°vel bin√°ria (dummy) igual a 1 para mulheres (0 caso contr√°rio), no sal√°rio (vari√°vel salariom) atrav√©s do modelo de regress√£o linear simples. O grupo interpreta o coeficiente de sexo. Algu√©m do grupo pergunta qual seria o sal√°rio m√©dio de homens de acordo com os resultados da regress√£o do grupo. A mesma pessoa pergunta se esse resultado seria suficiente para dizer que existe discrimina√ß√£o de g√™nero. O grupo responde as perguntas, justificando a resposta_

```{r}
mqo <- lm(salariom ~ sexo, data = pnad, na.action=na.exclude)
summary(mqo)

```
**R:** O Sal√°rio m√©dio dos homens, de acordo com o intercepto √© 1875,9 reais, caso for 1, ou seja, mulheres, h√° uma queda de 485,2 reais de sal√°rio, sendo assim seu sal√°rio m√©dio de 1390 reais.
Todavia isso nao √© o suficiente para determinar se o discriminacao de genero, dado que h√° outros fatores que podem levar a esse resultado, como tipo de trabalho que leva a essa remuneracao, anos de escolaridade, entre outros, ainda que seja um indicativo que isto pode ocorrer.


```{r,include=FALSE}
#testando a resposta acima
pnad %>% 
  filter(sexo == 0,
         salariom >= 0) %>% 
  select(salariom) %>% 
  summary(salariom)
```


#### *PERGUNTA 2*

_A vice-diretora olha os resultados preliminares e diz que √© importante colocar outras vari√°veis de controle no modelo acima, tais como escolaridade, idade,cor/ra√ßa e uma vari√°vel dummy igual a 1 se o indiv√≠duo mora em regi√£o rural (0 caso contr√°rio). O grupo roda a regress√£o incluindo as vari√°veis de controle e interpreta novamente o coeficiente de sexo, comparando com o coeficiente encontrado na quest√£o anterior._

```{r}
mq1 <- lm(salariom ~ sexo+educ+idade+cor+rural, data = pnad, na.action=na.exclude)
summary(mq1)
```
Nota-se uma mudanca no valor do intercepto e tamb√©m em sexo, quase dobrando o valor negativo para mulher, ou seja, as vari√°veis possuem alguma relacao entre si. 

A l√≥gica do modelo de regressao multipla √© _"O modelo de regress√£o linear m√∫ltipla mant√©m os valores das outras vari√°veis independentes fixos mesmo se houver correla√ß√£o"_

Logo no caso, mantendo as vari√°veis constantes:

- `sexo`: Ser mulher (1) diminui o sal√°rio em 802 reais
- `educ`: Um ano a mais de escolaridade aumenta o sal√°rio em 223 reais
- `idade`: Um ano a mais de vida aumenta a o sal√°rio em 39 reais
- `cor`: **?D√∫vida:** como explicar se cor possui v√°rias opcoes categoricas??
- `rural`: Morar em regiao rural diminui o sal√°rio em 333 reais

```{r, include=FALSE}
#testando relacao entre vari√°veis
lm(salariom ~ sexo+rural, data = pnad, na.action=na.exclude)

```


#### *PERGUNTA 3*

_O grupo mostra os resultados da regress√£o acima para a vice-diretora do centro de pesquisa. Ela pergunta se o grupo considerou um poss√≠vel efeito n√£o linear da idade no sal√°rio. O grupo cria uma vari√°vel de idade ao quadrado e *estima um modelo com `idade` e `idade ao quadrado` na regress√£o incluindo as vari√°veis da quest√£o anterior*. O grupo interpreta o coeficiente de idade_

```{r}
hist(pnad$idade)

pnad <- pnad %>% 
  mutate(idadequadrado = idade*idade)
```

Agora fazendo a regressao:

```{r}

mq2 <- lm(salariom ~ sexo+educ+idade+cor+rural+idadequadrado, data = pnad, na.action=na.exclude)
summary(mq2)

```
**R: **As informacoes no geral se mantiveram, no entanto, se nota uma diferenca do coeficiente para vari√°vel `idade` e da variavel `idadequadrado`, em que o primeiro est√° positivo e o segundo negativo, logo no primeiro a cada ano de idade, um aumento de 87 reais, enquanto no segundo a cada ano adicional de idade, deve-se aplicar o efeito na formula

Efeito marginal da idade: `219.1662idade - 2(-0.5851)idade`

J√° que: "A interpreta√ß√£o da estimativa do estimador de ùë•1 vai
depender do seu valor"

(Coment√°rio: modelo quadr√°tico. H√° valores √≥timos existentes, o quadratico vai gerar um gr√°fico de curva com ponto √≥timo, derivada igual a zero encontra o ponto √≥timo. A interpretacao muda:
o efeito √© um aumento ou diminuicao de b1+b2+2b2x)


#### *PERGUNTA 4*

_A vice-diretora do projeto sugere que seria interessante estimar usar a transforma√ß√£o logar√≠tmica na vari√°vel dependente, e pede para estimar uma _regress√£o do logaritmo natural do sal√°rio mensal no sexo e no n√∫mero de horas de afazeres dom√©sticos n√£o remunerado (vari√°vel horasdom)_, _al√©m das outras vari√°veis da quest√£o anterior. O grupo tenta rodar uma nova regress√£o usando o logaritmo natural do sal√°rio mensal como vari√°vel dependente e sexo e horas de afazeres dom√©sticos n√£o remunerado como vari√°veis explicativas, incluindo as vari√°veis de controle da quest√£o anterior, mas obt√©m o erro._

_O erro  quer dizer que a transforma√ß√£o logar√≠tmica produziu o valor -‚àû para indiv√≠duos sem sal√°rio mensal (ùë†ùëéùëô√°ùëüùëñùëúùëö = 0), pois o logaritmo natural de 0 n√£o √© determinado. O grupo conversa com uma aluna terminando sua disserta√ß√£o e ela sugere rodar o c√≥digo abaixo para transformar os valores -‚àû em dados faltantes (NA), onde pnad √© o nome do objeto que armazena a base de dados._
_O grupo corrige o problema e roda novamente a regress√£o linear do logaritmo natural do sal√°rio mensal no sexo, nas horas de trabalho dom√©stico n√£o remunerado e nas outras vari√°veis de controle da quest√£o anterior. Funcionou!!! Agora sim, O grupo interpreta os coeficientes das horas de afazeres dom√©stico n√£o remunerado, escolaridade e sexo_

```{r}
pnad <- pnad %>% 
  mutate(logsalariom = log(salariom))

is.na(pnad) <- sapply(pnad, is.infinite) # transformando todos os - Inf # em missing data (NA)

#modelo log linear, em que a vari√°vel dependente y fica com log
lqo3 <- lm(logsalariom ~ sexo+educ+idade+cor+rural+idadequadrado+horasdom, data = pnad, na.action=na.exclude)
summary(lqo3)

```

A interpretacao muda, pois nao tenho mais y, tenho `log(y)`, assim um aumento de uma unidade de `x` nao leva a um aumento esperado de b1 em y.
Aumentar 1 unidade `X` leva um aumento *relativo* de `b1*100%` em y

- `sexo`: -0.34*100 = Ser mulher e com as demais vari√°veis constantes leva a uma reducao de -34% do sal√°rio.
- `educ`: -0.10*100 = Cada ano de escolaridade e com as demais vari√°veis constantes leva a uma reducao -10% do sal√°rio (???)
- `idade`: 0.07*100 = 7%
- `cor`: -0.035*100 = -3.5% (nao sei como interpretar)
- `rural`: -0.36*100 = Ser do rural e com as demais vari√°veis constantes leva a uma reducao de -36% do sal√°rio
- `idadequadrado`: (0.07*100) - 2(-0.36*100) = 79%
- `horasdom`: -0.01*100 = A cada hora de atividade domiciliar e com as demais vari√°veis constantes leva a uma reducao -1% do sal√°rio


#### *PERGUNTA 5*

_Um aluno ingressante do mestrado acad√™mico pergunta sobre a(s) raz√£o(√µes) pela qual fazemos a transforma√ß√£o logar√≠tmica em uma vari√°vel dependente, e o grupo explica o(s) principais motivo(s)_

Motivos para usar o log:

1. Quando a relacao entre x e y √© exponencial e nao linear
2. Quando o res√≠duo nao possui distribuicao normal

Sendo assim, respectivamente:
1. lineariza as relacoes, reduz a complexidade das relacoes matem√°ticas.
2. O log de y, leva a um um padrao esperado de uma distribuicao normal, pois simetriza e concentra valores, entao tende tornar uma coisa assim√©trica para sim√©trica e trazer valores distantes para mais perto.

#### *PEGUNTA 6*

_Por fim, a vice-diretora comenta que a transforma√ß√£o logar√≠tmica nas horas de afazeres dom√©sticos tamb√©m poderia ser feita, pois poderia facilitar a interpreta√ß√£o. O grupo faz a transforma√ß√£o e estima o modelo da quest√£o 4. O grupo interpreta os coeficientes do log(‚Ñéùëúùëüùëéùë†ùëëùëúùëö) e escolaridade_

```{r}
pnad <- pnad %>% 
  mutate(loghorasdom = log(horasdom))

lqo4 <- lm(logsalariom ~ sexo+educ+idade+cor+rural+idadequadrado+loghorasdom, data = pnad, na.action=na.exclude)
summary(lqo4)

```

(Coment√°rios: Em caso de modelo linear log, onde y se mant√©m e o log ocorre nas vari√°veis independentes
Interpretacao aproximada/relativa.
aumentar 1% induz um aumento ou diminuicao de b1/100 unidades em y)

- `horasdom`: -0.131*100 = A cada hora de atividade domiciliar e com as demais vari√°veis constantes leva a uma reducao -13% do sal√°rio
- `educ`: 0.1*100 = A cada ano de escolaridade e com as demais vari√°veis constantes leva a um aumento de 10% do sal√°rio


##### Duvidas gerais para aula

- Como analisar o resultado quando h√° todas as formas combinadas (log-linear, linear-log, quadr√°tico)?
- Como avaliamos a relacao entre as vari√°veis independentes? Isso importa para an√°lise?
- Qual o momento que retiramos uma vari√°vel ou quando percebemos que ela nao √© relevante para o modelo?
- Como analisar o coeficiente quadr√°tico? Realmente a A interpreta√ß√£o da estimativa do estimador de ùë•1 vai depender do seu valor?
- Como interpretar o coeficiente de vari√°veis categoricas como cor?

